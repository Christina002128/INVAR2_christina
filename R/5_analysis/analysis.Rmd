---
title: "INVAR2 Analysis"
output: html_document
---

## Cohort by Mutant Context Plot

```{r fig.width = 6, fig.height = 5, echo = FALSE}
cohortMutationContextPlot(contextMutationsTable, study = scriptArgs$STUDY)
```

## AF by mutation class

```{r fig.width = 6, fig.height = 7, echo = FALSE}
cohortMutationAFByClassPlot(contextMutationsTable, study = scriptArgs$STUDY)
```

## Mutations per patient captured and passing pipeline filters

```{r fig.width = 6, fig.height = 7, echo = FALSE}
mutationsPerPatientPlot(patientSummaryTable, study = scriptArgs$STUDY)
```

## Mutation class distribution by cohort

```{r fig.width = 6, fig.height = 5, echo = FALSE}
mutationClassByCohortPlot(contextMutationsTable, study = scriptArgs$STUDY)
```

## Case vs control error rates

```{r fig.width = 8, fig.height = 4, echo = FALSE}
backgroundErrorCaseControlPlot(errorRatesINV042, study = scriptArgs$STUDY)
```

# Summary Plots

## Background error rates

```{r fig.width = 8, fig.height = 4, echo = FALSE}
backgroundErrorRatesPlot(errorRatesTable, study = scriptArgs$STUDY, familySize = scriptArgs$FAMILY_SIZE)
```

## Error rate comparison - both strands

```{r fig.width = 6, fig.height = 3, echo = FALSE}
errorRatePolishingComparisonPlot(errorRatesTable, "both_strands")
```

## Error rate comparison - locus noise

```{r fig.width = 6, fig.height = 3, echo = FALSE}
errorRatePolishingComparisonPlot(errorRatesTable, "locus_noise")
```

## Error rate comparison - locus noise &amp; both strands

```{r fig.width = 6, fig.height = 3, echo = FALSE}
errorRatePolishingComparisonPlot(errorRatesTable, "locus_noise.both_strands")
```

## Filtering comparison

```{r fig.width = 6, fig.height = 4, echo = FALSE}
filteringComparisonPlot(errorRatesTable, study = scriptArgs$STUDY, familySize = scriptArgs$FAMILY_SIZE)
```

# Outlier suppression plots

## Data retained

```{r fig.width = 5, fig.height = 6, echo = FALSE}
summaryCohortPlot(mutationsTable, study = scriptArgs$STUDY)
```

## Background polishing

```{r fig.width = 15, fig.height = 12, echo = FALSE}
backgroundPolishingPlot(mutationsTable,
                        study = scriptArgs$STUDY,
                        errorSuppression = scriptArgs$ERROR_SUPPRESSION,
                        outlierSuppression = scriptArgs$OUTLIER_SUPPRESSION)
```

# Tumour AF in observed and unobserved loci.

```{r fig.width = 5, fig.height = 4, echo = FALSE}
tumourAFInLociPlot(mutationsTable, study = scriptArgs$STUDY)
```

# Fragment size per cohort

With different levels of error-suppression.

```{r fig.width = 6, fig.height = 5, echo = FALSE}
fragmentSizePerCohortPlot(sizeCharacterisationSummary, study = scriptArgs$STUDY)
```

# Enrichment level

```{r fig.width = 6, fig.height = 5, echo = FALSE}
enrichmentLevelPlot(sizeCharacterisationSummary, study = scriptArgs$STUDY)
```

# Receiver Operating Characteristic (ROC) Plots

With size:

```{r fig.width = 4, fig.height = 3, echo = FALSE}
receiverOperatingCharacteristicPlot(invarScoresTable, layoutTable, TRUE,
                                    study = scriptArgs$STUDY,
                                    familySize = scriptArgs$FAMILY_SIZE)
```

Without size:

```{r fig.width = 4, fig.height = 3, echo = FALSE}
receiverOperatingCharacteristicPlot(invarScoresTable, layoutTable, FALSE,
                                    study = scriptArgs$STUDY,
                                    familySize = scriptArgs$FAMILY_SIZE)
```

# IR (depth) to IMAF

```{r fig.width = 6, fig.height = 4, echo = FALSE}
depthToIMAFPlot(ifPatientData$IF_PATIENT_DATA)
```

# Waterfall Plots

## Detectable vs non detectable using dPCR

```{r fig.width = 10, fig.height = 5, echo = FALSE}
detectableWaterfallPlot(annotatedPatientSpecificGLRT, study = scriptArgs$STUDY)
```

## Cancer genomes

```{r fig.width = 10, fig.height = 5, echo = FALSE}
cancerGenomesWaterfallPlot(annotatedPatientSpecificGLRT, study = scriptArgs$STUDY)
```

# dPCR comparision plot

```{r fig.width = 8, fig.height = 5, echo = FALSE}
dpcrComparisionPlot(annotatedPatientSpecificGLRT, study = scriptArgs$STUDY)
```
